## Техническое задание (ТЗ)

### 1. Общая информация

**Название проекта:** Платформа бронирования рабочих мест  
**Назначение:** Обеспечить пользователям возможность бронировать рабочие места в различных локациях с выбором даты бронирования (на сегодня и на завтра). Администратор управляет пользователями, локациями и рабочими местами.

### 2. Основные сущности и их атрибуты

1. **Пользователь (User):**
    
    - **Поля:**
        - `id` – уникальный идентификатор;
        - `login` – имя пользователя (логин);
        - `email` – адрес электронной почты;
        - `pass_hash` – хеш пароля;
        - `is_admin` – флаг администратора (True/False);
        - `status` – статус (например, активен/заблокирован);
        - `create_dt` – дата создания аккаунта.
    - **Примечание:** При развёртывании приложения автоматически создаётся администраторский аккаунт (admin).

2. **Локация (Location):**
    
    - **Поля:**
        - `id` – уникальный идентификатор;
        - `seat_count` – количество рабочих мест;
        - `name_location` - адрес локации
        - `address` – адрес (местоположение);
        - `create_dt` – дата создания локации;
        - `status` – статус локации (например, активна/неактивна).
    - **Функционал:** Локацию создаёт администратор. При создании указывается количество мест, и автоматически создаются записи рабочих мест.

3. **Место для бронирования (Seat):**
    
    - **Поля:**
        - `id` – уникальный идентификатор;
        - `location_id` – внешний ключ, связывающий с локацией.
    - **Примечание:** Места создаются автоматически при создании локации.

4. **Бронь (Booking):**
    
    - **Поля:**
        - `id` – уникальный идентификатор брони;
        - `user_id` – идентификатор пользователя, который сделал бронь;
        - `seat_id` – идентификатор рабочего места;
        - `booking_date` – дата бронирования (важно различать бронирование на сегодня и на завтра);
        - `create_dt` – дата и время создания брони;
        - `status` – статус брони (активна, отменена и т.д.).
    - **Особенности:**
        - Одно и то же место может быть забронировано дважды (на сегодня и на завтра).
        - Бронь действительна до её отмены или до 00:00 указанного дня.
        - Автоматический переход броней: бронь, забронированная на «завтра», становится бронью «на сегодня» после наступления 00:00.

### 3. Функциональные требования

1. **Авторизация и аутентификация:**
    
    - Реализовать страницу `/login` для входа.
    - Автоматическое создание администратора (admin) при развертывании.

2. **Управление пользователями (администратор):**
    
    - Возможность создавать, редактировать и удалять пользователей.
    - Контроль прав доступа через поле `is_admin`.

3. **Управление локациями и рабочими местами (администратор):**
    
    - Создание локаций с указанием `seat_count`, `address` и других атрибутов.
    - Автоматическое создание записей мест (Seat) при создании локации.

4. **Бронирование мест:**
    
    - **Страница `/booking`:** Отображение списка всех локаций, доступных для бронирования.
    - **Страница `/booking/<location_id>`:** Отображение всех рабочих мест выбранной локации с фильтром по дате бронирования (сегодня/завтра).
    - **Ограничения:**
        - Пользователь может забронировать только одно место на выбранную дату.
        - Если место уже забронировано другим пользователем, оно не должно быть доступно для повторного бронирования.
    - **Отмена брони:** Возможность отменить ранее сделанную бронь.

5. **Обновление состояния броней:**
    
    - Реализовать механизм, который в 00:00 обновляет статус броней (бронирование на «завтра» становится бронью на «сегодня»).
    - Возможное решение — использование планировщика задач (например, APScheduler) или проверка при входе пользователя.

### 4. Технические требования

- **Язык:** Python.
- **Фреймворк:** Flask.
- **База данных:** SQLite.
- **ORM:** SQLAlchemy.
- **Шаблонизация:** Jinja2.
- **Аутентификация:** Flask-Login или аналогичный модуль.
- **Безопасность:** Хеширование паролей с использованием безопасных алгоритмов (например, bcrypt или встроенные методы werkzeug).
- **Структура:** Приложение должно быть реализовано по принципу MVC (модели, шаблоны, контроллеры).

### 5. Страницы и маршруты

- `/login` – страница авторизации.
- `/booking` – страница выбора локации.
- `/booking/<location_id>` – страница просмотра и бронирования рабочих мест конкретной локации с возможностью выбора даты (сегодня/завтра).

### 6. Дополнительные замечания

- Код должен быть хорошо документирован и модульным, чтобы обеспечить масштабируемость.
- Необходимо предусмотреть обработку ошибок и валидацию данных.
- Интерфейс должен быть интуитивно понятным, обеспечивать корректное отображение доступности мест для бронирования.


### 7. Структура проекта 
```
booking_workplace/
├── static/
│   └── css/
│       ├── admin.css      # Стили для страницы админа
│       ├── base.css       # Стили для страницы бронирования
│       ├── booking.css    # Стили для страницы бронирования
│       ├── location.css   # Стили для страницы локации
│       └── login.css      # Стили для страницы входа
│       
│       
└── templates/    
│   ├── admin_panel.html   # Шаблон страницы панели администратора         
│   ├── base.html          # Общий шаблон (наследование для остальных)
│   ├── book_seat.html     # Шаблон страницы выбора мест
│   ├── booking.html       # Шаблон страницы выбора локации
│   ├── location.html      # Шаблон страницы конкретной локации с рабочими местами
│   └── login.html         # Шаблон страницы входа
│
├── app.py                 # Основной файл приложения Flask
├── config.py              # Конфигурация приложения
├── init_db.py             # Скрипт инициализации БД (создание таблиц и ТУЗ admin)
├── models.py              # Описание моделей (User, Location, Seat, Booking)
├── README.md              # Документация
└── requirements.txt       # Список зависимостей (Flask, Flask-Login, SQLite и т.д.)

```

### 8. Библиотеки:
```bash
pip install flask flask-sqlalchemy flask-login flask-wtf wtforms email-validator werkzeug

```
- **Flask** – основной веб-фреймворк.
- **Flask-SQLite** – работа с базой данных (ORM).
- **Flask-Login** – управление сессиями пользователей (авторизация, аутентификация).
- **Flask-WTF** – работа с веб-формами.
- **WTForms** – обработка и валидация форм.
- **Email-Validator** – валидация email в формах.
- **Werkzeug** – управление паролями (хеширование, проверка).



### 9. Инструкция по запуску программы:

1) Создать виртуальное окружение -
    ```bash
    python -m venv venv

    ```
2) Запустить - 
    ```bash
    .\venv\Scripts\activate
    
    ```
3) Запустить команду, если есть проблема с политиками безопасности PowerShell, которые запрещают выполнение скриптов -
    ```bash
    Set-ExecutionPolicy Unrestricted -Scope CurrentUser
    
    ```
3) В файле config.py заменить почту админа на свою
4) Установить библиотеки из файла cd .\Booking_workplace\ - 
    ```bash
    pip install -r requirements.txt
    
    ```
5) Запустить код из файла app.py
    ```bash
    python .\app.py
    
    ```
6) В консоле указать пароль админа и подтвердить ( пароль должен иметь > 8 символом )
7) Открыть localhost на port 5000

---Комментарии по приложению:
    Пароль user может иметь любое количество символов.
    Удалить админа можно, но кладёт программу, придётся делать перезапуск.
    Кнопка "сброса пароля" работает в тестовом режиме, user  может зайти под временным паролем 0000. Смена в режиме user не работает.
